<!DOCTYPE html>
<!--
* Tabler - Premium and Open Source dashboard template with responsive and high quality UI.
* @version 1.0.0-beta20
* @link https://tabler.io
* Copyright 2018-2023 The Tabler Authors
* Copyright 2018-2023 codecalm.net Paweł Kuna
* Licensed under MIT (https://github.com/tabler/tabler/blob/master/LICENSE)
-->
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, viewport-fit=cover"
        />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>
            Charts - Tabler - Premium and Open Source dashboard template with
            responsive and high quality UI.
        </title>
        <!-- CSS files -->
        <link href="./dist/css/tabler.min.css?1692870487" rel="stylesheet" />
        <link
            href="./dist/css/tabler-flags.min.css?1692870487"
            rel="stylesheet"
        />
        <link
            href="./dist/css/tabler-payments.min.css?1692870487"
            rel="stylesheet"
        />
        <link
            href="./dist/css/tabler-vendors.min.css?1692870487"
            rel="stylesheet"
        />
        <link href="./dist/css/demo.min.css?1692870487" rel="stylesheet" />
        <style>
            @import url("https://rsms.me/inter/inter.css");
            :root {
                --tblr-font-sans-serif: "Inter Var", -apple-system,
                    BlinkMacSystemFont, San Francisco, Segoe UI, Roboto,
                    Helvetica Neue, sans-serif;
            }
            body {
                font-feature-settings: "cv03", "cv04", "cv11";
            }
        </style>
    </head>
    <body>
        <script src="./dist/js/demo-theme.min.js?1692870487"></script>
        <div class="page">
            <header class="navbar-expand-md">
                <div class="collapse navbar-collapse" id="navbar-menu">
                    <div class="navbar">
                        <div class="container-xl">
                            <ul class="navbar-nav">
                                <li class="nav-item">
                                    <a class="nav-link" href="./">
                                        <span
                                            class="nav-link-icon d-md-none d-lg-inline-block"
                                            ><!-- Download SVG icon from http://tabler-icons.io/i/home -->
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="icon"
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                stroke-width="2"
                                                stroke="currentColor"
                                                fill="none"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path
                                                    stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none"
                                                />
                                                <path
                                                    d="M5 12l-2 0l9 -9l9 9l-2 0"
                                                />
                                                <path
                                                    d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"
                                                />
                                                <path
                                                    d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"
                                                />
                                            </svg>
                                        </span>
                                        <span class="nav-link-title">
                                            Home
                                        </span>
                                    </a>
                                </li>
                            </ul>
                            <div
                                class="my-2 my-md-0 flex-grow-1 flex-md-grow-0 order-first order-md-last"
                            >
                                <form
                                    action="./"
                                    method="get"
                                    autocomplete="off"
                                    novalidate
                                >
                                    <div class="input-icon">
                                        <span class="input-icon-addon">
                                            <!-- Download SVG icon from http://tabler-icons.io/i/search -->
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="icon"
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                stroke-width="2"
                                                stroke="currentColor"
                                                fill="none"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path
                                                    stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none"
                                                />
                                                <path
                                                    d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"
                                                />
                                                <path d="M21 21l-6 -6" />
                                            </svg>
                                        </span>
                                        <input
                                            type="text"
                                            value=""
                                            class="form-control"
                                            placeholder="Search…"
                                            aria-label="Search in website"
                                        />
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <div class="page-wrapper">
                <!-- Page header -->
                <div class="page-header d-print-none">
                    <div class="container-xl">
                        <div class="row g-2 align-items-center">
                            <div class="col">
                                <h2 class="page-title">Charts</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Page body -->
                <div class="page-body">
                    <div class="container-xl">
                        <div class="row row-cards">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex">
                                            <h3 class="card-title">
                                                API Request Summary
                                            </h3>
                                            <div class="ms-auto">
                                                <div class="dropdown">
                                                    <a
                                                        class="dropdown-toggle text-secondary"
                                                        href="#"
                                                        data-bs-toggle="dropdown"
                                                        aria-haspopup="true"
                                                        aria-expanded="false"
                                                        >Last 7 days</a
                                                    >
                                                    <div
                                                        class="dropdown-menu dropdown-menu-end"
                                                    >
                                                        <a
                                                            class="dropdown-item active"
                                                            href="#"
                                                            >Last 7 days</a
                                                        >
                                                        <a
                                                            class="dropdown-item"
                                                            href="#"
                                                            >Last 30 days</a
                                                        >
                                                        <a
                                                            class="dropdown-item"
                                                            href="#"
                                                            >Last 3 months</a
                                                        >
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="chart-social-referrals"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <footer class="footer footer-transparent d-print-none">
                    <div class="container-xl">
                        <div
                            class="row text-center align-items-center flex-row-reverse"
                        >
                            <div class="col-lg-auto ms-lg-auto">
                                <ul class="list-inline list-inline-dots mb-0">
                                    <li class="list-inline-item">
                                        <a
                                            href="https://tabler.io/docs"
                                            target="_blank"
                                            class="link-secondary"
                                            rel="noopener"
                                            >Documentation</a
                                        >
                                    </li>
                                    <li class="list-inline-item">
                                        <a
                                            href="./license.html"
                                            class="link-secondary"
                                            >License</a
                                        >
                                    </li>
                                    <li class="list-inline-item">
                                        <a
                                            href="https://github.com/tabler/tabler"
                                            target="_blank"
                                            class="link-secondary"
                                            rel="noopener"
                                            >Source code</a
                                        >
                                    </li>
                                    <li class="list-inline-item">
                                        <a
                                            href="https://github.com/sponsors/codecalm"
                                            target="_blank"
                                            class="link-secondary"
                                            rel="noopener"
                                        >
                                            <!-- Download SVG icon from http://tabler-icons.io/i/heart -->
                                            <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                class="icon text-pink icon-filled icon-inline"
                                                width="24"
                                                height="24"
                                                viewBox="0 0 24 24"
                                                stroke-width="2"
                                                stroke="currentColor"
                                                fill="none"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            >
                                                <path
                                                    stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none"
                                                />
                                                <path
                                                    d="M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"
                                                />
                                            </svg>
                                            Sponsor
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-12 col-lg-auto mt-3 mt-lg-0">
                                <ul class="list-inline list-inline-dots mb-0">
                                    <li class="list-inline-item">
                                        Copyright &copy; 2023
                                        <a href="." class="link-secondary"
                                            >Tabler</a
                                        >. All rights reserved.
                                    </li>
                                    <li class="list-inline-item">
                                        <a
                                            href="./changelog.html"
                                            class="link-secondary"
                                            rel="noopener"
                                        >
                                            v1.0.0-beta20
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <!-- Libs JS -->
        <script
            src="./dist/libs/apexcharts/dist/apexcharts.min.js?1692870487"
            defer
        ></script>
        <!-- Tabler Core -->
        <script src="./dist/js/tabler.min.js?1692870487" defer></script>
        <script src="./dist/js/demo.min.js?1692870487" defer></script>
        <script>
            async function fetchData(project_id, range) {
                const apiUrl = "http://localhost:8000/api/request-chart";

                // Function to encode the query parameters
                const encodeParams = (params) => {
                    const queryString = Object.keys(params)
                        .map(
                            (key) =>
                                encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(params[key])
                        )
                        .join("&");
                    return queryString;
                };

                // Specify the parameters
                const params = {
                    project_id: project_id,
                    range: range,
                };

                // Construct the full URL with encoded parameters
                const fullUrl = apiUrl + "?" + encodeParams(params);

                // Make the fetch request
               return fetch(fullUrl)
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error(
                                `HTTP error! Status: ${response.status}`
                            );
                        }
                        return response.json();
                    })
                    .then((data) => {
                        // Process the response data
                        console.log("Response data:", data);
                        return data;
                    })
                    .catch((error) => {
                        console.error("Fetch error:", error);
                    });
            }
        </script>
        <script async>
            function renderChart(project1, project2, project3) {
                console.log(project1, project2, project3);
                window.ApexCharts &&
                    new ApexCharts(
                        document.getElementById("chart-social-referrals"),
                        {
                            chart: {
                                type: "line",
                                fontFamily: "inherit",
                                height: 288,
                                parentHeightOffset: 0,
                                toolbar: {
                                    show: false,
                                },
                                animations: {
                                    enabled: false,
                                },
                            },
                            fill: {
                                opacity: 1,
                            },
                            stroke: {
                                width: 2,
                                lineCap: "round",
                                curve: "smooth",
                            },
                            series: [
                                {
                                    name: "User 1",
                                    data: project1.count,
                                },
                                {
                                    name: "User 2",
                                    data: project2.count,
                                },
                                {
                                    name: "User 3",
                                    data: project3.count,
                                },
                            ],
                            tooltip: {
                                theme: "dark",
                            },
                            grid: {
                                padding: {
                                    top: -20,
                                    right: 0,
                                    left: -4,
                                    bottom: -4,
                                },
                                strokeDashArray: 4,
                                xaxis: {
                                    lines: {
                                        show: true,
                                    },
                                },
                            },
                            xaxis: {
                                labels: {
                                    padding: 0,
                                },
                                tooltip: {
                                    enabled: false,
                                },
                            },
                            yaxis: {
                                labels: {
                                    padding: 4,
                                },
                            },
                            labels: project1.timestamp,
                            colors: [
                                tabler.getColor("facebook"),
                                tabler.getColor("twitter"),
                                tabler.getColor("dribbble"),
                            ],
                            legend: {
                                show: true,
                                position: "bottom",
                                offsetY: 12,
                                markers: {
                                    width: 10,
                                    height: 10,
                                    radius: 100,
                                },
                                itemMargin: {
                                    horizontal: 8,
                                    vertical: 8,
                                },
                            },
                        }
                    ).render();
            }

            async function load() {
                // @formatter:off
                var project1 = await fetchData("project-id-1", "1_day");
                var project2 = await fetchData("project-id-2", "1_day");
                var project3 = await fetchData("project-id-3", "1_day");
                renderChart(project1, project2, project3);
            }

            load();

            // @formatter:on
        </script>
    </body>
</html>
